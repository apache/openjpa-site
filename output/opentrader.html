<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html lang="en">
    <head>
        <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
        <link href="/styles/site.css" rel="stylesheet" type="text/css"/>
        <!-- <link href="/styles/type-settings.css" rel="stylesheet" type="text/css"/> -->
        <link href="/css/type-settings.css" rel="stylesheet" type="text/css"/>
        <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
        <META name="Description" content="Apache OpenJPA -- OpenTrader" />
        <META name="Keywords" content="Apache OpenJPA, JPA, JPA 1.0, JSR-220, JPA2, JPA 2.0, JSR-317, " />
        <META name="Owner" content="dev@openjpa.apache.org" />
        <META name="Robots" content="index, follow" />
        <META name="Security" content="Public" />
        <META name="Source" content="wiki template" />
        <META name="DC.Date" scheme="iso8601" content="2010-08-11" />
        <META name="DC.Language" scheme="rfc1766" content="en" />
        <META name="DC.Rights" content="Copyright Â© 2006,2025 The Apache Software Foundation" />
        <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>
	<style>
.headerlink {
  visibility: hidden;
}
dt:hover > .headerlink, p:hover > .headerlink, td:hover > .headerlink, h1:hover > .headerlink, h2:hover > .headerlink, h3:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, h6:hover > .headerlink {
  visibility: visible
}	</style>
        <title>Apache OpenJPA -- OpenTrader</title>
    </head>
    <body>
        <div class="white_box">
            <div class="header">
                <div class="header_l">
                    <div class="header_r">
                    </div>
                </div>
            </div>
            <div class="content">
                <div class="content_l">
                    <div class="content_r">
                        <div>
                            <!-- Banner -->
                            <TABLE valign="top" border="0" cellspacing="0" cellpadding="5" width="100%" background="images/header-bg3.png">
                                <TR>
                                    <TD valing="top" align="left">
                                        <A href="https://openjpa.apache.org/"><IMG src="/images/openjpa-logo.png" border="0" alt="OpenJPA Logo"></A>
                                    </TD>
                                    <TD width="100%">
                                        &nbsp;
                                    </TD>
                                    <TD valing="top" align="right">
                                        <A href="https://www.apache.org/"><IMG src="/images/asf_logo_wide2.png" border="0" alt="ASF Logo"></A>
                                    </TD>
                                </TR>
                            </TABLE>

                            <!-- Navigation Bar -->
                            <div class="bottom_red_bar">
                                <div id="site-breadcrumbs">
                                </div>
                            </div>

                            <!-- Content -->
                            <table border="0">
                                <tbody>
                                    <tr>
                                        <td valign="top">
                                            <div class="navigation">
                                                <div class="navigation_top">
                                                    <div class="navigation_bottom">
                                                        <!-- NavigationBar -->
                                                        <h3><a name="SideNav-Overview"></a><a href="/overview.html" title="Overview">Overview</a></h3>

                                                        <ul class="alternate" type="square">
                                                            <li><a href="/quick-start.html" title="Quick Start">Quick Start</a></li>
                                                            <li><a href="/downloads.html" title="Downloads">Downloads</a></li>
                                                            <li><a href="/documentation.html" title="Documentation">Documentation</a></li>
                                                            <li><a href="/site-index.html" title="Site Index">Site Index</a></li>
                                                            <li><a href="/license.html" title="License">License</a></li>
                                                            <li><a href="/privacy-policy.html" title="Privacy Policy">Privacy Policy</a></li>
                                                        </ul>

                                                        <h3><a name="SideNav-Community"></a><a href="/community.html" title="Community">Community</a></h3>

                                                        <ul class="alternate" type="square">
                                                            <li><a href="/index.html#Index-eventsandnews" title="Events and News">Events and News</a></li>
                                                            <li><a href="/found-a-bug.html" title="Found a Bug">Found a Bug</a>?</li>
                                                            <li><a href="/get-involved.html" title="Get Involved">Get Involved</a></li>
                                                            <li><a href="/mailing-lists.html" title="Mailing Lists">Mailing Lists</a></li>
                                                            <li><a href="/committers.html" title="Committers">Committers</a></li>
                                                            <li><a href="/integration.html" title="Integration">Integration</a></li>
                                                            <li><a href="/powered-by.html" title="Powered By">Powered By</a></li>
                                                            <li><a href="/thanks.html" title="Thanks">Thanks</a></li>
                                                        </ul>


                                                        <h3><a name="SideNav-Development"></a><a href="/development.html" title="Development">Development</a></h3>

                                                        <ul class="alternate" type="square">
                                                            <li><a href="/downloads-nightly.html" title="Downloads">Nightly Downloads</a></li>                                        
                                                            <li><a href="/source-code.html" title="Source Code">Source Code</a></li>
                                                            <li><a href="/testing.html" title="Testing">Testing</a></li>
                                                            <li><a href="https://issues.apache.org/jira/browse/OPENJPA" class="external-link" rel="nofollow">Issue Tracker</a></li>
                                                            <li><a href="/tools.html" title="Tools">Tools</a></li>
                                                            <li><a href="/samples.html" title="Samples">Samples</a></li>
                                                            <li><a href="/release-management.html" title="Release Management">Release Management</a></li>
                                                        </ul>

                                                        <h3><a name="SideNav-Consumers"></a><a href="/consumers.html" title="Consumers">Consumers</a></h3>

                                                        <ul class="alternate" type="square">
                                                            <li><a href="/tips-n-techniques.html" title="Tips and Techniques">Tips and Techniques</a></li>
                                                            <li><a href="/troubleshoot.html" title="Trouble Shoot">Trouble Shoot</a></li>
                                                        </ul>

                                                        <h3>Search</h3>

                                                        <div style="padding: 5px 5px 0px 25px;">
                                                            <form action="https://www.google.com/search" method="get" style="font-size: 10px;">
                                                                <input name="ie" type="hidden" value="UTF-8">
                                                                <input name="oe" type="hidden" value="UTF-8">
                                                                <input maxlength="255" name="q" size="15" type="text" value=""><br><br>
                                                                <input name="btnG" type="submit" value="Google">
                                                                <input name="domains" type="hidden" value="openjpa.apache.org">
                                                                <input name="sitesearch" type="hidden" value="openjpa.apache.org">
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td valign="top" width="100%" style="overflow:hidden;">
                                            <div class="wiki-content">
    <p><a name="OpenTrader"></a></p>
<p>h1. OpenTrader: a transactional, web application with Google Web Toolkit,
OpenJPA/Slice on Tomcat</p>
<p><img alt="OpenTrader-login.gif" src="images/OpenTrader-login.gif"/></p>
<p>OpenTrader is a sample web application to demonstrate integration of Google
Web Toolkit (GWT) and OpenJPA running in Tomcat Servlet Container. These
pages describe various aspects of this end-to-end application. The
following sections are fairly independent of each other and can be followed
as such based on your interest.</p>
<ul>
<li><a href="opentraderarchitecture.html">Architecture</a>
and core design goals</li>
<li>The <a href="opentraderenvironment.html">computing environment</a>
requirement</li>
<li>Developing a <a href="opentraderclient.html">GWT Client</a></li>
<li>Developing a <a href="opentraderserver.html">JPA based Server</a></li>
<li><a href="opentradercommunication.html">Communication</a>
between the components</li>
<li><a href="opentraderbuild.html">Building</a>
the application</li>
<li><a href="opentraderdeploy.html">Deploying</a>
the application</li>
</ul>
<p>GWT takes a position that is a significantly unique among the multitude of
frameworks available to build a browser based client. GWT framework is
based on several key concepts:</p>
<ul>
<li>an asynchronous RPC protocol for communication between web client and
server. Such asynchronous RPC is popularized by AJAX (Asynchronous
JavaScript and XML) since last several years.</li>
<li>a cross-compiler that converts Java to JavaScript. This is the most
critical component in the framework as it allows the client be written
completely in Java. Besides adding a comfort layer for Java developers, the
cross-compiler solves one of the most complex issue of browser based
clients namely cross-browser compatibility. The cross-compiler generates
separate JavaScript targeted to prominent browsers and the framework knows
to activate the appropriate JavaScript based on the particular browser a
client is using.</li>
<li>a library of interactive visual widgets such as dialog boxes,
combo-boxes, tables etc. This Java based library realizes the widget as the
elements of a Document Object Model (DOM) for a browser to render them in
HTML. For example, an instance of <strong>com.google.gwt.user.client.ui.FlexTable</strong>
urns into a <strong>&lt;table&gt;</strong> in the
displayed HTML page by the framework. The widget library not only provides
rendering support, it also comes with a event dispatching model for the
client application to handle the user interaction.</li>
</ul>
<p>OpenTrader - the sample example described in these pages - demonstrates how
to develop a GWT client for a transactional, server application based on
Java Persistence API (JPA). This example is somewhat more involved than a
typical AddressBook example in terms of the complexity of the domain model,
the transactional functions of the server as well as the interaction
between multiple widgets in the client. Also the sample application covers
a realistic use case where the core server application is defined
independent of both GWT and JPA -- and then demonstrates how these two
technologies are used to <em>implement</em> an end-to-end service running inside a
Tomcat Servlet Container.</p>
<p>Follow the steps to view OpenTrader source code, build the application,
deploy it in your favorite application container and run it in your
favorite browser.</p>
<p><a name="OpenTrader-1.Getthesourcecode"></a></p>
<h3 id="1-get-the-source-code">1. Get the source code<a class="headerlink" href="#1-get-the-source-code" title="Permalink">&para;</a></h3>
<p>OpenTrader source code is available as one of the OpenJPA examples.
Checkout the source files in a directory.</p>
<p>$ svn checkout <a href="https://svn.apache.org/repos/asf/openjpa/trunk/openjpa-examples/opentrader">https://svn.apache.org/repos/asf/openjpa/trunk/openjpa-examples/opentrader</a></p>
<p>The source tree comes with</p>
<ul>
<li>Ant build script: <em>build.xml</em> and <em>build.properties</em></li>
<li>Java source code for OpenTrader application under <em>src/main/java</em></li>
<li>GWT module descriptor  : <em>OpenTrader.gwt.xml</em> under <em>src/main/java/org/apache/openjpa/trader</em></li>
<li>Persistence descriptor : <em>persistence.xml</em> under <em>src/main/resources/META-INF</em></li>
<li>web descriptor	    : <em>web.xml</em> under <em>src/main/resources/WEB-INF</em></li>
<li>cascading style sheet  : <em>OpenTrader.css</em> under <em>src/main/resources/css</em></li>
</ul>
<p><a name="OpenTrader-2.Build"></a></p>
<h3 id="2-build">2. Build<a class="headerlink" href="#2-build" title="Permalink">&para;</a></h3>
<p>To build OpenTrader you will require following other libraries.</p>
<ul>
<li><strong>Google Web Toolkit</strong>: We have built it with GWT version 2.0.4 which
can be downloaded from <a href="http://google-web-toolkit.googlecode.com/files/gwt-2.0.4.zip">here</a>
.</li>
<li><strong>cobogw widget library</strong>: Provides rounded panel not using them seems
to be too un-cool. Download version 1.3.1 from <a href="http://code.google.com/p/cobogw/downloads/list">here</a>
.</li>
<li>and, of course, <strong>OpenJPA libraries</strong>: OpenJPA now comes with all its
dependencies neatly packaged in a single jar including the JPA API.
Download from <a href="http://www.apache.org/dyn/closer.cgi/openjpa/2.0.0/apache-openjpa-2.0.0-binary.zip">this site</a>
.</li>
</ul>
<h4 id="21-configure-build-environment">2.1 Configure build environment<a class="headerlink" href="#21-configure-build-environment" title="Permalink">&para;</a></h4>
<p>Edit  <strong>build.properties</strong> to point to the dependent libraries you
have downloaded. The file contains the instructions as comments.</p>
<h4 id="22-compile-with-ant">2.2 Compile with Ant<a class="headerlink" href="#22-compile-with-ant" title="Permalink">&para;</a></h4>
<p>Compile the application. Compilation involves three separate
compilation process. First the plain old <strong>javac</strong> compilation. Followed by
GWT cross-compiler that translates Java code into JavaScript. And finally
OpenJPA compilation that adds few bytecodes to the persistent classes to
manage their persistent behavior (which is also known as bytecode
enhancement).</p>
<pre><code>$ ant compile
</code></pre>
<p>GWT Compiler takes ages. Even though it only compiles for a single
browser (FireFox). This is controlled by the following directives in the
module descriptor <em>OpenTrader.gwt.xml</em></p>
<pre><code>&lt;set-property name="user.agent" value="gecko1_8"/&gt; 
</code></pre>
<p><a name="OpenTrader-3.Run"></a></p>
<h3 id="3-run">3. Run<a class="headerlink" href="#3-run" title="Permalink">&para;</a></h3>
<p>You can run either in <em>hosted</em> mode - an environment provided by GWT to
run within a Jetty container - or in a proper servlet container such as
Tomcat, Geronimo or GlassFish or even heavy-duty ones such as WebSphere or
Weblogic. In either case, you have to configure the <em>persistence.xml</em>
found under <strong>src/main/resources/META-INF</strong>. This descriptor specifies the
database used by OpenTrader.</p>
<pre><code>&lt;property name="openjpa.ConnectionDriverName" value="com.mysql.jdbc.Driver"/&gt;
&lt;property name="openjpa.ConnectionURL" value="jdbc:mysql://localhost/exchange"/&gt;
&lt;property name="openjpa.ConnectionUserName" value="whoami"/&gt;
&lt;property name="openjpa.ConnectionPassword" value="secret"/&gt;
</code></pre>
<p>Also edit the <strong>jdbc.driver</strong> in <strong>build.properties</strong> for the
driver/database you have selected.</p>
<p>Now, for hosted mode, simply fire Ant as</p>
<pre><code> $ ant devmode
</code></pre>
<p>This should again take a very long time and pop open a horrible looking
Swing console titled <strong>GWT Development Mode</strong>. Go to <strong>Development Mode</strong> tab
and click <strong>Launch Default Browser</strong>. On my FireFox browser, that opens up
the page
<a href="http://127.0.0.1:8888/OpenTrader.html?gwt.codesvr=127.0.0.1:9997">http://127.0.0.1:8888/OpenTrader.html?gwt.codesvr=127.0.0.1:9997</a>. If
all goes well, at this point your browser will prompt you with a welcome
dialog box</p>
<p><img alt="OpenTrader-login.gif" src="images/OpenTrader-login.gif"/></p>
<p>Once you have entered OpenTrader, the browser application looks like</p>
<p><img alt="OpenTrader-screenshot.gif" src="images/OpenTrader-screenshot.gif"/></p>
<p>In this page, you can place a trade offer to sell or buy some stocks. To
really commit a trade you will need a matching offer. Now as a trader offer
can only match to another trader's offer, you need to open another browser
page with a different name. In FireFox, the tab will show the Trader name.
Now if one Trader makes an offer that match another Trader's offer, then
clicking the <strong>Sell</strong> or <strong>Buy</strong> button will commit the trade and will
appear on the Trading History Window. Also notice the Server Log window.
That will display SQL issued for every action by the server. You will also
notice SQL being logged even if you are not pressing any buttons. Thatis
because the Market Data Panel (the one in th etop-left corner) is
refreshing the market prices for the Stocks by a periodic call to the
server. As the stock prices change, that change is reflected on the
gain/loss column of the waiting trade offers. All this dynamic partial
update occurs in the same browser page -- that is what GWT offers.</p>

                                            </div>
                                        </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="bottom_red_bar"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="black_box">
                    <div class="footer">
                        <div class="footer_l">
                            <div class="footer_r">
                                <div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="design_attribution">
                Copyright &copy; 2006,2025 The Apache Software Foundation. Licensed under <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a>.<br />
                Apache, the Apache feather logo and OpenJPA are trademarks of The Apache Software Foundation.<br />
                Other names may be trademarks of their respective owners.<br />
            </div>
    </body>
</html>