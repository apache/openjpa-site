<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html lang="en">
    <head>
        <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
        <link href="/styles/site.css" rel="stylesheet" type="text/css"/>
        <!-- <link href="/styles/type-settings.css" rel="stylesheet" type="text/css"/> -->
        <link href="/css/type-settings.css" rel="stylesheet" type="text/css"/>
        <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
        <META name="Description" content="Apache OpenJPA -- Writing Test Cases For OpenJPA" />
        <META name="Keywords" content="Apache OpenJPA, JPA, JPA 1.0, JSR-220, JPA2, JPA 2.0, JSR-317, " />
        <META name="Owner" content="dev@openjpa.apache.org" />
        <META name="Robots" content="index, follow" />
        <META name="Security" content="Public" />
        <META name="Source" content="wiki template" />
        <META name="DC.Date" scheme="iso8601" content="2010-08-11" />
        <META name="DC.Language" scheme="rfc1766" content="en" />
        <META name="DC.Rights" content="Copyright Â© 2006,2025 The Apache Software Foundation" />
        <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>
	<style>
.headerlink {
  visibility: hidden;
}
dt:hover > .headerlink, p:hover > .headerlink, td:hover > .headerlink, h1:hover > .headerlink, h2:hover > .headerlink, h3:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, h6:hover > .headerlink {
  visibility: visible
}	</style>
        <title>Apache OpenJPA -- Writing Test Cases For OpenJPA</title>
    </head>
    <body>
        <div class="white_box">
            <div class="header">
                <div class="header_l">
                    <div class="header_r">
                    </div>
                </div>
            </div>
            <div class="content">
                <div class="content_l">
                    <div class="content_r">
                        <div>
                            <!-- Banner -->
                            <TABLE valign="top" border="0" cellspacing="0" cellpadding="5" width="100%" background="images/header-bg3.png">
                                <TR>
                                    <TD valing="top" align="left">
                                        <A href="https://openjpa.apache.org/"><IMG src="/images/openjpa-logo.png" border="0" alt="OpenJPA Logo"></A>
                                    </TD>
                                    <TD width="100%">
                                        &nbsp;
                                    </TD>
                                    <TD valing="top" align="right">
                                        <A href="https://www.apache.org/"><IMG src="/images/asf_logo_wide2.png" border="0" alt="ASF Logo"></A>
                                    </TD>
                                </TR>
                            </TABLE>

                            <!-- Navigation Bar -->
                            <div class="bottom_red_bar">
                                <div id="site-breadcrumbs">
                                </div>
                            </div>

                            <!-- Content -->
                            <table border="0">
                                <tbody>
                                    <tr>
                                        <td valign="top">
                                            <div class="navigation">
                                                <div class="navigation_top">
                                                    <div class="navigation_bottom">
                                                        <!-- NavigationBar -->
                                                        <h3><a name="SideNav-Overview"></a><a href="/overview.html" title="Overview">Overview</a></h3>

                                                        <ul class="alternate" type="square">
                                                            <li><a href="/quick-start.html" title="Quick Start">Quick Start</a></li>
                                                            <li><a href="/downloads.html" title="Downloads">Downloads</a></li>
                                                            <li><a href="/documentation.html" title="Documentation">Documentation</a></li>
                                                            <li><a href="/site-index.html" title="Site Index">Site Index</a></li>
                                                            <li><a href="/license.html" title="License">License</a></li>
                                                            <li><a href="/privacy-policy.html" title="Privacy Policy">Privacy Policy</a></li>
                                                        </ul>

                                                        <h3><a name="SideNav-Community"></a><a href="/community.html" title="Community">Community</a></h3>

                                                        <ul class="alternate" type="square">
                                                            <li><a href="/index.html#Index-eventsandnews" title="Events and News">Events and News</a></li>
                                                            <li><a href="/found-a-bug.html" title="Found a Bug">Found a Bug</a>?</li>
                                                            <li><a href="/get-involved.html" title="Get Involved">Get Involved</a></li>
                                                            <li><a href="/mailing-lists.html" title="Mailing Lists">Mailing Lists</a></li>
                                                            <li><a href="/committers.html" title="Committers">Committers</a></li>
                                                            <li><a href="/integration.html" title="Integration">Integration</a></li>
                                                            <li><a href="/powered-by.html" title="Powered By">Powered By</a></li>
                                                            <li><a href="/thanks.html" title="Thanks">Thanks</a></li>
                                                        </ul>


                                                        <h3><a name="SideNav-Development"></a><a href="/development.html" title="Development">Development</a></h3>

                                                        <ul class="alternate" type="square">
                                                            <li><a href="/downloads-nightly.html" title="Downloads">Nightly Downloads</a></li>                                        
                                                            <li><a href="/source-code.html" title="Source Code">Source Code</a></li>
                                                            <li><a href="/testing.html" title="Testing">Testing</a></li>
                                                            <li><a href="https://issues.apache.org/jira/browse/OPENJPA" class="external-link" rel="nofollow">Issue Tracker</a></li>
                                                            <li><a href="/tools.html" title="Tools">Tools</a></li>
                                                            <li><a href="/samples.html" title="Samples">Samples</a></li>
                                                            <li><a href="/release-management.html" title="Release Management">Release Management</a></li>
                                                        </ul>

                                                        <h3><a name="SideNav-Consumers"></a><a href="/consumers.html" title="Consumers">Consumers</a></h3>

                                                        <ul class="alternate" type="square">
                                                            <li><a href="/tips-n-techniques.html" title="Tips and Techniques">Tips and Techniques</a></li>
                                                            <li><a href="/troubleshoot.html" title="Trouble Shoot">Trouble Shoot</a></li>
                                                        </ul>

                                                        <h3>Search</h3>

                                                        <div style="padding: 5px 5px 0px 25px;">
                                                            <form action="https://www.google.com/search" method="get" style="font-size: 10px;">
                                                                <input name="ie" type="hidden" value="UTF-8">
                                                                <input name="oe" type="hidden" value="UTF-8">
                                                                <input maxlength="255" name="q" size="15" type="text" value=""><br><br>
                                                                <input name="btnG" type="submit" value="Google">
                                                                <input name="domains" type="hidden" value="openjpa.apache.org">
                                                                <input name="sitesearch" type="hidden" value="openjpa.apache.org">
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td valign="top" width="100%" style="overflow:hidden;">
                                            <div class="wiki-content">
    <p><a name="WritingTestCasesForOpenJPA-TipsonwritingTestCaseforOpenJPA"></a></p>
<h1 id="tips-on-writing-testcase-for-openjpa">Tips on writing TestCase for OpenJPA<a class="headerlink" href="#tips-on-writing-testcase-for-openjpa" title="Permalink">&para;</a></h1>
<p>You are welcome to contribute new test cases. Following are few suggestions
and guidelines on how to contribute new test case to OpenJPA repository of
2000 test cases spread across 400 classes.</p>
<h2 id="inherit-from-openjpa-testcases">Inherit from OpenJPA TestCases<a class="headerlink" href="#inherit-from-openjpa-testcases" title="Permalink">&para;</a></h2>
<p>Unit Tests are <strong>JUnit</strong> Tests. The base JUnit test case implementation
<em>org.junit.TestCase</em> has been extended to facilitate common
initialization steps or configuration settings for unit testing OpenJPA.
The inheritance hierarchy is:</p>
<pre>
        <code>
            junit.framework.TestCase
               +-- org.apache.openjpa.persistence.test.PersistenceTestCase
                   +-- org.apache.openjpa.persistence.test.SingleEMFTestCase
            	  +-- org.apache.openjpa.persistence.test.SQLListenerTestCase
        </code>
</pre>
<p>As a test developer, you should inherit your test class from one of the
extended TestCases. In general, <em>SingleEMFTestCase</em> is a good candidate
to inherit from. If your test needs to analyze or count number of SQL
statements, <em>SQLListenerTestCase</em> should be your choice.</p>
<h2 id="use-correct-name-and-package-for-test-case-and-entity-classes">Use correct name and package for test case and entity classes<a class="headerlink" href="#use-correct-name-and-package-for-test-case-and-entity-classes" title="Permalink">&para;</a></h2>
<ul>
<li>Test case should be in a separate sub-package of
<em>org.apache.openjpa.persistence.</em> <strong>or</strong> <em>org.apache.openjpa.persistence.jdbc.</em>*</li>
<li>Test case class names must start with "Test" e.g. <strong>TestEagerFetch</strong></li>
<li>There are hundreds of testable entity classes. But if your test requires
new entity classes, place them in the same package as that of the new Test
cases.</li>
</ul>
<h2 id="setup-and-teardown">setUp() and tearDown()}<a class="headerlink" href="#setup-and-teardown" title="Permalink">&para;</a></h2>
<ul>
<li>
<p>OpenJPA TestCases augment the <strong>setUp()</strong> method to accept a list of
arguments. In this list, you should specify:</p>
</li>
<li>
<p>the entity classes used by your test</p>
</li>
<li>
<p>the critical configuration properties</p>
</li>
<li>
<p><strong>CLEAR_TABLES</strong> or <strong>DROP_TABLES</strong> : these are constants declared in
the superclass which clears the existing rows or drops the tables
altogether.</p>
</li>
<li>
<p>The following is an example <em>setUp()</em> method</p>
</li>
</ul>
<pre class="code codeContent">
        <code>
            public void setUp() throws Exception {
                super.setUp(CLEAR_TABLES,               // clears records for domain classes
            	  Candidate.class, Election.class,      // registers Candidate and Election as persistence-capable entity
            	  "openjpa.Multithreaded", "true",      // sets configuration property as name-value pairs
            	  "openjpa.Log", "SQL=TRACE");	     
            }
        </code>
</pre>
<ul>
<li>Notice that some configuration parameters can be set in the <em>setUp()</em>
method of test program itself. This is recommended for properties that are
important for your test. The non-critical parameters such as database
connection properties (unless your test is about some specific aspect of a
particular database) are better be specified in
<em>META-INF/persistence.xml</em>. The persistence name can be specified by
overwriting the following method:</li>
</ul>
<pre>
        <code>
        protected String getPersistenceUnitName() {
                return "test-eager-fetch";
        }
        </code>
</pre>
<ul>
<li><em>SingleEMFTestCase</em> ensures that <em>tearDown()</em> method deletes all rows
for the domain classes involved in your test. You may want the database
records to remain for analysis especially when tests are failing. In that
case, you may consider suppressing the superclass behavior of
<em>tearDown()</em> by simply nullifying the method as</li>
</ul>
<pre>
        <code>
            public void tearDown() throws Exception {
                 // avoids super class to delete all records
            }
        </code>
</pre>
<h2 id="annotate-o-r-mapping">Annotate O-R Mapping<a class="headerlink" href="#annotate-o-r-mapping" title="Permalink">&para;</a></h2>
<p>Prefer annotation over XML Descriptors for O-R Mapping because that helps
to collocate relevant information. Unless, of course, the test is specific
about variations in behavior across annotation and XML Descriptors.</p>
<h2 id="use-junit-assert-methods">Use JUnit assert*() methods<a class="headerlink" href="#use-junit-assert-methods" title="Permalink">&para;</a></h2>
<p>For verification, use many assertion methods provided by <em>JUnit</em> e.g.
<strong>assertEquals()</strong> or <strong>assertTrue()</strong> rather than depending on printing
trace with <strong>System.out.println()</strong>. If you want to trace generated SQL or
other runtime information, use appropriate <strong>openjpa.Log</strong> property
settings.</p>
<h2 id="create-jira-issue">Create JIRA Issue<a class="headerlink" href="#create-jira-issue" title="Permalink">&para;</a></h2>
<p>Create a JIRA issue. Refer to the JIRA issue in the comments section of the
new test case.</p>
<h2 id="asf-license">ASF License<a class="headerlink" href="#asf-license" title="Permalink">&para;</a></h2>
<p>Remember to include ASF License header in the comment section of all the
new source or resource files.</p>
<h2 id="attach-the-test-to-jira-issue">Attach the test to JIRA Issue<a class="headerlink" href="#attach-the-test-to-jira-issue" title="Permalink">&para;</a></h2>
<p>Package all the *.java files related to your test case in a JAR file and
attach it to JIRA issue you have created.
You must check in the radio button <strong>Grant license to ASF for inclusion in
ASF works</strong> that appears near the bottom of <strong>Attach File</strong> JIRA page.</p>

                                            </div>
                                        </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="bottom_red_bar"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="black_box">
                    <div class="footer">
                        <div class="footer_l">
                            <div class="footer_r">
                                <div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="design_attribution">
                Copyright &copy; 2006,2025 The Apache Software Foundation. Licensed under <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a>.<br />
                Apache, the Apache feather logo and OpenJPA are trademarks of The Apache Software Foundation.<br />
                Other names may be trademarks of their respective owners.<br />
            </div>
    </body>
</html>